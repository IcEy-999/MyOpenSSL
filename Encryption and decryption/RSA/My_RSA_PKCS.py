

import time
def tool(c,cf,n):
    t = c
    a= 1
    while(cf!= 0):
        if(cf&1!=0):
            a = a * t
            a = a%n
        cf = cf >>1
        t = t*t
        t = t %n
    return a

def fast(c,n,e,d,p,q,dmp,dmq,crt):
    mp  = tool(c,dmp,p)
    mq = tool(c,dmq,q)
    if mp > mq:
        h = mp - mq
    else:
        h = mq - mp
        h = p-h
    h = h * crt
    h = h % p
    h = h * q
    mm = h + mq
    return mm


n = 0xAC5A73C08928872F5142E03EA6879247DA51BB4A05B9943B4D53F13403B2AB26925B10A0E728C041B7DC85E7B4051DDA70674A15A19EABD0AD93BC859480AE7C28CC1113BDE4ED13E2CC3C3F5BF0D39B7AC7E0E7D7632669C7248F3B34DBD98A617FB211FF59790436CAFD8F23E7F68F2E0308891DDD66481F8D3A30ADD93878ACB36E4F0690B75BA45FD5C2B19416D2FD881AACD7B204C6D3C4502E8D1477A756214C6C0B0379CD81F6AE60F4DCD2DBF438D13D26EF2F55F69749FA59AC4CB5E2C88BF3684301DEEAD0BC704D1C56D4FBA4D5367628B449577DAC975BD74ED6870D1802D8B55156F8C5D09523B4197105B73ED204ADE6E6068B78D645AC3DED
e = 0x10001
d = 0x2A5B485B26DA08EEFDFF7B70AA286330B95CA0B47E57AF302BBED7663B0A6BB95CFA7849B2C5770A2F8F48713AF28EF5A1EE206CD47D542842A02E127DFE69E3257B912ED2DA31D1534971FCF831652FAEAAF480C5941E5A9C90458AFD609243C9D64202DE4834CF6E4FD0A49EE460D9AB2B1FABE2E5083FED511DDDDCBBA77EC955E25FD8D8092949C9F2B7CCC61F37A05F8B39E7EC1A83A3258A4E15FF91117496DE359C1028349DA9E850F47D783D6EA8B44EBA7C656887AE3EA34516DA8DBC7664810D9692FF3BD6983CA4A9C526053FC6F99359EA392A0F93EEAC29F802F8E19E3A326CD7743E578A7339EB187058402DC80C81C0C5D7FDE94BA72EF519
p = 0x00D901735D7AF0EC42B4C41B2AF512137ABD51B0D57B61FFF3D13AB2064ED87454FC2BA71473C110EB4F96203F1BB63FE486587266588C2C6F89685C65E08C2E9EDB277DF193AB488BA489EEFF12DC4CC59D34438BADA4B6D35E427B0B8E5098895DCB46397F1C4AB7626F73B638FBA1C5BD90D3A8EF32B710D20126B91A546B3F
q = 0x00CB52EF3FD2C54E0452435083F8AFB9F26F9789524DC0BCB2BFC2D8F1156C200B057D6FFDF0C011A4255DF2E41191F272912916D859ECA119E873452ADF84631046386BA2BF344F26D9F90B61518B92EAAD78ABF79CF0BF94DE4B372B39A1BAF5A179A7E41B35E06D54DAC8E925AF4E72769607D8C78145235CFAF63FE02EE7D3
dmp = 0x6224CDD05171F4E89668BB00CAA5CA3990B6098C03A966E11697BD3C2D1CA840676C36BC813DA83144655960316053B53F2D714FE86C3D0C94D0A6394D3D1938AF554518A4F8AA6EBD93C48B88342A64959CB58FCE90D83EF03A90FBC0F9A2833DF0596A579AAC10146CE3A05E552FED06B721831DEB89F0098A8BC0DBAFA271
dmq = 0x14F9BC56E03E9C9AD385C043AD1F2BD6B7EE712B3D7C39BB530F1DE4592A6B6FD7A4262E936CAD253AF9A33A2619E162325983D2D40C165E9EDD6D704BD8D383754B12C79A64221A46F86B5521DD7D4D9A91CD63E11BF117C18B0EE8F5AC1AA6867F0F73F7DEAA057D7088B38CC0B61E16DFC97572B78253709F2F524DA56923
crt = 0x7ECD05E781CFC0CE985CE621FDFAF4C49FE82BB374DD401B9F0E9CF79A01F832045FF36FE84CC9D8D7D65706F7EEEE7E93BC0797D9F93C0B47FDC127CF8F9E2DF4CA1CAC425431499658F93C0FFC30B48DCACF4B65BEC4ED995AB80A888E630FCE883EB710BA94D17F75B6A2117FCAD957C4678F993B7E4141300216C6FF6ED1

c = 0x4E22940C45AED44EE6320B62F18E3ED64E65FEFAF9419849EE18AFD0E2253129A8C34DFCE939CEF68712004756351BC7C6B7EA98443B18DA6CFFB14029338DBACEDCB27551214EC1875D014F446957AC99C75F6E806D1305E85D4FDF0353025A1EAA242AE395E36053A3A6B8B7DA5FF14723F43832A5F03A7485C05950FA840571AF12D53E10C239E8F4346FA93A8E31BF446A4506804370A7DCA2E4DB140CABC7EF3CE26D6E66D79D185EB307CDA52DE0CA84E449E6A84D97B94AD3B1272A3BD3717C5A10FCD1431476057A64E0ED789073BF8E4B1709DBD58C3FAB5A0997E5B2E5560FE35A1C5433014193B9A100F48069969BD0B02AE4291BDE3782C1D873

time1 = time.time()

#mm = tool(c,d,n)
mm = fast(c,n,e,d,p,q,dmp,dmq,crt)
time2 = time.time() - time1  #2.2 s
print("%#x"%mm)
print("a")

